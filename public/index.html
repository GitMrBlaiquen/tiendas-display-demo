<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Display Sensor</title>
  <style>
    * { box-sizing: border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      background:#0A2342;
      color:#fff;
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }
    .wrap{ width:100%; max-width:1200px; text-align:center; }
    .sn{
      font-size: clamp(18px, 3vw, 38px);
      opacity:.9;
      margin-bottom: 18px;
      word-break: break-all;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 22px;
    }
    .card{
      background: rgba(255,255,255,.10);
      border: 4px solid rgba(255,255,255,.18);
      border-radius: 18px;
      padding: 26px 18px;
    }
    .label{
      font-size: clamp(18px, 2.6vw, 32px);
      opacity:.9;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }
    .value{
      font-size: clamp(64px, 10vw, 140px);
      font-weight: 900;
      line-height: 1;
    }
    .status{
      margin-top: 18px;
      opacity:.85;
      font-size: clamp(14px, 2vw, 20px);
    }
    @media (max-width: 720px){
      .grid{ grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="sn" id="snText">SN: ...</div>

    <div class="grid">
      <div class="card">
        <div class="label">ENTRADAS</div>
        <div class="value" id="inVal">0</div>
      </div>

      <div class="card">
        <div class="label">SALIDAS</div>
        <div class="value" id="outVal">0</div>
      </div>
    </div>

    <div class="status" id="status">Conectando...</div>
  </div>

  <script>
    // Server principal (tu Render actual)
    const MAIN_API_BASE = "https://sensor-server-54ak.onrender.com";

    // SN fijo (1 SN por link demo)
    const SN = "221000002507152508";

    const snText = document.getElementById("snText");
    const inVal = document.getElementById("inVal");
    const outVal = document.getElementById("outVal");
    const status = document.getElementById("status");

    snText.textContent = "SN: " + SN;

    async function tick(){
      try{
        const url = `${MAIN_API_BASE}/api/display?sn=${encodeURIComponent(SN)}`;
        const res = await fetch(url, { cache: "no-store" });
        if(!res.ok) throw new Error("HTTP " + res.status);
        const data = await res.json();

        inVal.textContent = Number(data.entradas || 0);
        outVal.textContent = Number(data.salidas || 0);

        status.textContent = "Actualizado: " + new Date().toLocaleTimeString();
      }catch(e){
        status.textContent = "Sin datos / error: " + e.message;
      }
    }

    tick();
    setInterval(tick, 2000);
  </script>
</body>
</html>
